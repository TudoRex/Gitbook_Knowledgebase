# 量化交易/程序化交易
----------
[https://www.zhihu.com/question/25404359]()

Python,  编程语言不亏是知乎最热话题。
数据接口 
TuShare -财经数据接口包
策略研究平台
优矿-通联量化实验室
交易平台
vn.py - 基于python的开源交易平台开发框架

----------

作者：rabbit
链接：https://www.zhihu.com/question/25404359/answer/152815251
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。

之前编写策略主要是用python，所以逛得比较多的量化平台一直是Joinquant和优矿。
这两个平台的使用体验是非常方便，但是有些时候跑每日回测的速度比较感人，
后来我一直是基于python自己直接编写回测。最近因为编写策略的过程中越来越用到复杂的数值计算，
python在这一方面还是和matlab逊色不少。于是我开始转向matlab编写策略，
但是国内目前基于matlab的交易软件和平台相当至少。
一个偶然的机遇，在人大经管论坛上接触到了auto-trader这个软件，迫不及待地下载了这个软件尝试使用了一下。
楼主学习matlab基本都是借助DigQuant社区上面的策略直接上手写代码，DigQuant社区上面放了大量的策略代码，
而且全是基于matlab的策略代码，这对于一个matlab小白的重要性不言而喻，非常适合上手！
Auto-trader平台上的数据非常之全，从股票到商品期货，股指期货、指数、基金几乎囊括，
最主要的是提供了各种强大的金融函数与金融工具箱，且速度非常快！
编写代码的效率也比joinquant提高了太多，基本上可以节省大量的时间用在构思策略上，
这一点我觉得相比主流的优矿，ricequant，joinquant 丝毫不逊色。

## Java性能问题

作者：董可人
链接：https://www.zhihu.com/question/20019066/answer/29920408
来源：知乎
著作权归作者所有，转载请联系作者获得授权。

首先金融工程这个学科并不是教你如何做交易，主要学的是做衍生品定价。据我有限的了解，国外的课程里很多还是在教怎么用 C++ 实现定价计算。但这不代表现状就是正确的选择。我认为这个属于历史遗留问题，金融业吸收 IT 新技术需要时间。事实上写过 C++ 就会发现，这种语言对学金融工程的人来说是多么不友好，难学难用。很多业界的公司会开发自己的脚本语言供 Quant 使用，再由专门的程序把脚本翻译成快速实现。

所以，对于学金融工程 Master 来说，的确需要学好编程，但具体什么语言不是很重要。如果你觉得去上培训班能更有效率的学习，那么可以一试。如果是学 Java，只需要学 SE 即可。至于认证，它所代表的东西，也许对一些商业银行的后台事务性系统开发会有一些帮助，但是对 Quant 或高性能交易系统来说是完全无关的，我也没有听说过任何招聘此类工作的公司会要求这些认证。

而对于交易系统来说，C++ 也绝对不是唯一的选择。现有的几个回答都提到要追求性能必须使用 C++：

	个人感觉在10ms以下就必须要动用大杀器C/C++了。
	
	真心不建议使用Java，Java的速度确实要比C或C++慢，国内外金融相关的程序化交易软件都是用C/C++写的，比如国外非常成熟的MT5，国内做高频的股票软件不太熟悉（股票一般没有做高频的）。主要说下期货软件，期货软件目前大部分使用的是上期的CTP接口，最快能做到250ms一个数据，只有C的速度可以匹配上这样的频繁调用，Java这个时候就是个渣了。
	
	如果你从事的工作是平台开发，那么只有c++一条路，说什么java现在性能也很快，jvm优化的越来越好的，都是在误导。首先所谓的java性能越来越好，不过是针对简单的运算而言，而java耗时在于gc，而且你还不确定什么时候gc，可能在交易关键点上，系统来个gc。。。交易系统最怕的就是不确定性。

这应该代表了一种市面上的主流看法，但是遗憾的是这种理解是错误的。首先10ms完全是不需要任何优化都可以做到的水平，估计就连 Python 都能轻松处理（250ms就不要提了，这个是来搞笑的吗？）。Java 程序即使不做优化，做到百微秒级的水平也是不难的。实际上经过 JIT 处理后，字节码是直接翻译到机器码的，并且因为是动态编译，越是复杂的算法，越能得到更好的优化，甚至可能得到比 C++ 更好的性能。

而 GC 更是实际上可以控制的。这里有两个原则，第一是精确控制 GC 的触发时间，第二是对 GC 调优减少耗时。对第一点，JVM 有特定的指令用来触发 GC（见 JVM(TM) Tool Interface 1.2.1），可以自己控制 GC 时机。对第二点，官方的 HotSpot 虚拟机自带很多 GC 参数可以调节就不说了，而针对交易特别开发的 Zing 更是针对实时应用做了专门优化。另外为追求性能做到极致的话，最好的方法是不要 GC。比如自己做一个 Pool 来缓存对象，而不要每次都 new 一个新的。当然这些需要对 Java 的运行机制有深刻理解，但是相比复杂的 C++ 来说，Java 的开发难度绝对不在一个数量级上（怎么样才算是精通 C++？，Java真的比C++简单吗？）。

事实上，真正对性能有高要求的话，大部分功夫都要花在语言之外。Memory Hierarchy怎么控制，进程间通信怎么处理，网络传输怎么做，这些对性能的影响都要远远超过语言本身。举个简单的例子，大家应该都知道文件读写操作是很耗时的，那么你也许会举例来吐槽 Java 的 nio，再讲讲 C++ 怎么做异步。但实际上呢？这些都弱爆了，根本就没抓到点上。用 Memory-mapped file，直接读写内存，不需要经过 syscall，比什么 I/O API 都快，而你真正需要关心的问题其实是系统级的 Page faults。任何语言只要支持这种操作，用起来效果都一样（想看实例的话请看这里：Java-Chronicle）。

对这些有深入理解以后就会发现，如果你采用 C++ 作为主开发语言的话，后果就是承受所有 C++ 在开发上的不便，却只能得到仅仅在语言范围内的非常有限的性能提升（甚至还不一定有），而随着系统复杂度的增加最终会倒在开发和维护瓶颈上。

另外值得一提的是，对于交易系统这种对稳定性极度敏感的应用，当你的 C++ 系统在运行时因为某种意想不到的原因（比如网络数据 corrupted，或者程序 bug）而 coredump 的时候，才真正让你欲哭无泪，很可能连排查问题的希望都没有。在这方面 Java 的相对成熟的异常处理机制是有先天优势的。

注：
感谢 @梁川 给出的这个链接：[虚拟研讨会：在低延迟环境中使用Java](https://link.zhihu.com/?target=http%3A//www.infoq.com/cn/articles/low-latency-vp)，提供了更丰富的观点和讨论。其中的 Peter Lawrey 是 Java 的性能专家，为很多高频交易业者提供咨询服务，我也从他的文章中得到过很多启发。此人是 Stack Overflow 上 Java 话题下排名第三的贡献者，看他的博客 Vanilla #Java 绝对帮你对 Java 的理解正三观。对他的工作感兴趣的朋友可以看如下两个 Slides：
[http://www.slideshare.net/PeterLawrey/introduction-to-chronicle-low-latency-persistence]()
[http://www.slideee.com/slide/open-hft-libraries-in-java]()

另外一个值得看的博客是[Mechanical Sympathy](https://link.zhihu.com/?target=http%3A//mechanical-sympathy.blogspot.co.uk/)，也提供了很多 Java 性能方面的文章。
编辑于 2014-09-03